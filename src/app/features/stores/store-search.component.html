

<form class="search-form" (ngSubmit)="onSearch()">
  <input type="text" [(ngModel)]="city" name="city" placeholder="City (e.g., San Francisco)"/>
  <input type="text" [(ngModel)]="zip" name="zip" placeholder="ZIP (e.g., 94110)"/>
  <button type="submit">Search</button>
  <button type="button" (click)="useMyLocation()">Use my location</button>
</form>

<div *ngIf="stores && stores.length === 0" class="muted">No stores found.</div>

<ul class="store-list">
  <li *ngFor="let s of stores" (click)="loadSpots(s)" class="store">
    <div class="title">{{ s.name }}</div>
    <div class="meta">
      <span *ngIf="s.city">{{ s.city }}</span>
      <span *ngIf="s.zipCode">• {{ s.zipCode }}</span>
      <span *ngIf="s.averageRating !== undefined">• ★ {{ s.averageRating }} ({{ s.reviewCount || 0 }})</span>
    </div>

    <div *ngIf="spots[s.id]" class="spots" (click)="$event.stopPropagation()">
      <div *ngFor="let sp of spots[s.id]" class="spot">
        <span>${{ sp.pricePerDay }}/day</span>
        <span [class.bad]="!sp.available">{{ sp.available ? 'Available' : 'Unavailable' }}</span>
        <!--            <button type="button" [routerLink]="['/book', sp.id]" [disabled]="!sp.available">Book</button>-->
        <button (click)="book(s.id, sp.id)">Book</button>
      </div>
    </div>
  </li>
</ul>
